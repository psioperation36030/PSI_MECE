<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°•ì˜ MECE ë°ì´í„° ìˆ˜ì§‘ ì‹œíŠ¸</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Malgun Gothic', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh; padding: 20px;
        }
        .container {
            max-width: 1400px; margin: 0 auto; background: rgba(255, 255, 255, 0.95);
            border-radius: 20px; box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden; backdrop-filter: blur(10px);
        }
        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white; padding: 30px; text-align: center;
        }
        .header h1 { font-size: 2.2em; margin-bottom: 10px; text-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        .header p { opacity: 0.9; font-size: 1.1em; }
        .form-container { padding: 30px; }

        .basic-info {
            background: #f8f9ff; padding: 25px; border-radius: 15px; margin-bottom: 30px; border-left: 5px solid #4facfe;
        }
        .basic-info h2 { color: #333; margin-bottom: 20px; font-size: 1.4em; }
        .info-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
        .form-group { display: flex; flex-direction: column; }
        .form-group label { font-weight: bold; color: #555; margin-bottom: 8px; font-size: 0.95em; }
        .form-group input, .form-group select {
            padding: 12px; border: 2px solid #e1e5e9; border-radius: 8px; font-size: 1em; transition: all 0.3s ease;
        }
        .form-group input[type="date"] { cursor: pointer; position: relative; }
        .form-group input[type="date"]::-webkit-calendar-picker-indicator {
            cursor: pointer; position: absolute; top: 0; left: 0; right: 0; bottom: 0; width: auto; height: auto; color: transparent; background: transparent;
        }
        .form-group input:focus, .form-group select:focus {
            outline: none; border-color: #4facfe; box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
        }

        .mece-section h2 {
            color: #333; margin-bottom: 20px; font-size: 1.4em; text-align: center;
        }
        .module-controls {
            display: flex; justify-content: center; gap: 15px; margin-bottom: 25px;
        }
        .module-btn {
            background: linear-gradient(135deg, #e9ecef 0%, #dee2e6 100%);
            color: #6c757d; border: none; padding: 10px 20px; border-radius: 25px; cursor: pointer; transition: all 0.3s ease; font-weight: bold;
        }
        .module-btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        .module-btn.active { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        .module-btn:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }

        .mece-table-container { overflow-x: auto; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .mece-table { width: 100%; border-collapse: collapse; background: white; min-width: 800px; }
        .mece-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white; padding: 15px; text-align: left; font-weight: bold; position: sticky; top: 0; z-index: 10;
        }
        .mece-table th.question-col { width: 200px; min-width: 200px; }
        .mece-table th.module-col { width: 200px; min-width: 180px; text-align: center; }
        .mece-table td { padding: 12px; border: 1px solid #e1e5e9; vertical-align: top; }
        .mece-table td.question-cell { background: #f8f9ff; font-weight: bold; color: #555; }

        .module-name-input {
            width: 100%; padding: 8px; border: 2px solid #4facfe; border-radius: 6px; background: #f0f8ff;
            text-align: center; font-weight: bold; color: #333;
        }
        .mece-input {
            width: 100%; min-height: 60px; padding: 8px; border: 1px solid #ddd; border-radius: 6px; resize: vertical; font-family: inherit; transition: border-color 0.3s ease;
        }
        .mece-input:focus { outline: none; border-color: #4facfe; box-shadow: 0 0 0 2px rgba(79, 172, 254, 0.1); }

        .submit-section { text-align: center; margin-top: 30px; padding-top: 30px; border-top: 2px solid #f0f0f0; }
        .submit-btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white; border: none; padding: 15px 40px; border-radius: 30px; font-size: 1.1em; font-weight: bold;
            cursor: pointer; transition: all 0.3s ease; box-shadow: 0 5px 15px rgba(79, 172, 254, 0.3);
        }
        .submit-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(79, 172, 254, 0.4); }

        .success-message {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white; padding: 30px 40px; border-radius: 20px; box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            text-align: center; font-size: 1.2em; font-weight: bold; z-index: 1000;
            display: none; animation: fadeInOut 3s ease-in-out;
        }
        @keyframes fadeInOut {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
            20% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            80% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
        }

        .error-message { color: #ff4757; font-size: 0.85em; margin-top: 5px; font-weight: bold; display: none; }
        .error-border { border-color: #ff4757 !important; box-shadow: 0 0 0 2px rgba(255, 71, 87, 0.2) !important; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“š PSIì»¨ì„¤íŒ… ê°•ì˜ ë°ì´í„° ì·¨í•© ì‹œíŠ¸</h1>
            <p>ê°•ì˜ ê°„ ì£¼ìš” ì‚¬í•­ ë° íŠ¹ì´ì‚¬í•­ì„ ê¸°ì¬í•´ì£¼ì„¸ìš”! ì½˜í…ì¸  ì¤‘ë³µ ì´ìŠˆ ë°©ì§€ ëª©ì ì…ë‹ˆë‹¤.</p>
        </div>

        <div class="form-container">
            <!-- ê¸°ë³¸ ì •ë³´ -->
            <div class="basic-info">
                <h2>ğŸ“‹ ê°•ì˜ ê¸°ë³¸ì •ë³´</h2>
                <div class="info-grid">
                    <div class="form-group">
                        <label for="instructor">ê°•ì‚¬ë‹˜ ì„±í•¨</label>
                        <select id="instructor" required>
  <option value="">ì„ íƒí•´ì£¼ì„¸ìš”</option>

  <!-- ã„± -->
  <option value="ê°•ì™„ì„­">ê°•ì™„ì„­</option>
  <option value="ê°•ìœ¤ì•„">ê°•ìœ¤ì•„</option>
  <option value="ê¹€ê´‘í˜„">ê¹€ê´‘í˜„</option>
  <option value="ê¹€ì˜í•™">ê¹€ì˜í•™</option> <!-- ì¶”ê°€ í™•ì¸ -->
  <option value="ê¹€ì§€ë‚˜">ê¹€ì§€ë‚˜</option>
  <option value="ê¹€íƒœì€">ê¹€íƒœì€</option>

  <!-- ã…‚ -->
  <option value="ë°•ê°€ì˜">ë°•ê°€ì˜</option>
  <option value="ë°•ê´‘ì„±">ë°•ê´‘ì„±</option>
  <option value="ë°•íƒœì›…">ë°•íƒœì›…</option>

  <!-- ã…… -->
  <option value="ì‹ ê¸°í˜¸">ì‹ ê¸°í˜¸</option> <!-- ì¶”ê°€ -->

  <!-- ã…‡ -->
  <option value="ì—°ì œìµ">ì—°ì œìµ</option>
  <option value="ì´ê·œì™„">ì´ê·œì™„</option>
  <option value="ì´ì •í›ˆ">ì´ì •í›ˆ</option>
  <option value="ì´ì£¼ì—°">ì´ì£¼ì—°</option>
  <option value="ì´ì¹˜ë¯¼">ì´ì¹˜ë¯¼</option>

  <!-- ã…ˆ -->
  <option value="ì¥ë¯¸í™”">ì¥ë¯¸í™”</option> <!-- ì¶”ê°€ -->
  <option value="ì¥ì€ì•„">ì¥ì€ì•„</option>

  <!-- ã…Š -->
  <option value="ìµœì˜¤ì„±">ìµœì˜¤ì„±</option>
</select>

                        <div class="error-message" id="instructor-error">ê°•ì‚¬ë‹˜ì„ ì„ íƒí•´ì£¼ì„¸ìš”!</div>
                    </div>

                    <div class="form-group">
                        <label for="company">ê³ ê°ì‚¬ëª…</label>
                        <input type="text" id="company" required>
                        <div class="error-message" id="company-error">ì—†ìœ¼ë©´ 'ì—†ìŒ' ë˜ëŠ” 'X'ë¡œ ê¸°ì¬í•´ì£¼ì„¸ìš”!</div>
                    </div>

                    <div class="form-group">
                        <label for="course">ê³¼ì •ëª…</label>
                        <input type="text" id="course" required>
                        <div class="error-message" id="course-error">ì—†ìœ¼ë©´ 'ì—†ìŒ' ë˜ëŠ” 'X'ë¡œ ê¸°ì¬í•´ì£¼ì„¸ìš”!</div>
                    </div>

                    <div class="form-group">
                        <label for="date">ê°•ì˜ ë‚ ì§œ</label>
                        <input type="date" id="date" required>
                        <div class="error-message" id="date-error">ê°•ì˜ ë‚ ì§œë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”!</div>
                    </div>
                </div>
            </div>

            <!-- MECE -->
            <div class="mece-section">
                <h2>ğŸ“Š ê°•ì˜ MECE</h2>

                <div class="module-controls">
                    <button class="module-btn" onclick="setModuleCount(1)">1ê°œ ëª¨ë“ˆ</button>
                    <button class="module-btn" onclick="setModuleCount(2)">2ê°œ ëª¨ë“ˆ</button>
                    <button class="module-btn" onclick="setModuleCount(3)">3ê°œ ëª¨ë“ˆ</button>
                    <button class="module-btn" onclick="setModuleCount(4)">4ê°œ ëª¨ë“ˆ</button>
                    <button class="module-btn" onclick="setModuleCount(5)">5ê°œ ëª¨ë“ˆ</button>
                </div>

                <div class="mece-table-container">
                    <table class="mece-table" id="meceTable">
                        <thead>
                            <tr>
                                <th class="question-col">êµ¬ë¶„</th>
                                <th class="module-col">M1</th>
                                <th class="module-col">M2</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="question-cell">ëª¨ë“ˆëª…</td>
                                <td><input type="text" class="module-name-input" placeholder="ëª¨ë“ˆëª… ì…ë ¥"></td>
                                <td><input type="text" class="module-name-input" placeholder="ëª¨ë“ˆëª… ì…ë ¥"></td>
                            </tr>
                            <tr>
                                <td class="question-cell"><strong>ì•„ì´ìŠ¤ë¸Œë ˆì´í‚¹</strong> ì†Œì¬</td>
                                <td><textarea class="mece-input"></textarea></td>
                                <td><textarea class="mece-input"></textarea></td>
                            </tr>
                            <tr>
                                <td class="question-cell"><strong>ì§„ë‹¨</strong></td>
                                <td><textarea class="mece-input"></textarea></td>
                                <td><textarea class="mece-input"></textarea></td>
                            </tr>
                            <tr>
                                <td class="question-cell">ì‚¬ìš© <strong>ë™ì˜ìƒ</strong></td>
                                <td><textarea class="mece-input"></textarea></td>
                                <td><textarea class="mece-input"></textarea></td>
                            </tr>
                            <tr>
                                <td class="question-cell"><strong>ìŠ¤íŒŸ/ì•¡í‹°ë¹„í‹°</strong></td>
                                <td><textarea class="mece-input"></textarea></td>
                                <td><textarea class="mece-input"></textarea></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ì „ì²´ ê°•ì˜ ê´€ë ¨ ì •ë³´ -->
            <div class="basic-info" style="margin-top: 30px;">
                <h2>ğŸ“ ì „ì²´ ê°•ì˜ ê´€ë ¨ ì •ë³´</h2>
                <div class="form-group">
                    <label for="learnerReaction">í•™ìŠµì ë°˜ì‘</label>
                    <textarea id="learnerReaction" class="mece-input" style="height: 100px;" placeholder="í•™ìŠµ ì¥ë©´ì—ì„œì˜ ì „ì²´ ë°˜ì‘ì„ ê¸°ì¬í•´ì£¼ì„¸ìš”."></textarea>
                    <div class="error-message" id="learnerReaction-error">ì—†ìœ¼ë©´ 'ì—†ìŒ' ë˜ëŠ” 'X'ë¡œ ê¸°ì¬í•´ì£¼ì„¸ìš”!</div>
                </div>
                <div class="form-group" style="margin-top: 20px;">
                    <label for="specialNotes">ê¸°íƒ€(ê°•ì‚¬ ì˜ê²¬ ë° ê°œì„  ì‚¬í•­)</label>
                    <textarea id="specialNotes" class="mece-input" style="height: 100px;" placeholder="ê°•ì‚¬ ì˜ê²¬ ë° ê°œì„  ì‚¬í•­ì„ ììœ ë¡­ê²Œ ê¸°ì¬í•´ì£¼ì„¸ìš”."></textarea>
                    <div class="error-message" id="specialNotes-error">ì—†ìœ¼ë©´ 'ì—†ìŒ' ë˜ëŠ” 'X'ë¡œ ê¸°ì¬í•´ì£¼ì„¸ìš”!</div>
                </div>
            </div>

            <div class="submit-section">
                <button class="submit-btn" onclick="submitData()">ğŸ“¤ ì œì¶œí•˜ê¸°</button>
            </div>
        </div>

        <!-- ì„±ê³µ ë©”ì‹œì§€ -->
        <div class="success-message" id="successMessage">
            âœ… ì œì¶œì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.<br>ì†Œì¥ë‹˜ ê°ì‚¬í•©ë‹ˆë‹¤! ğŸ˜Š
        </div>
    </div>

    <script>
        // === (ì„ íƒ) êµ¬ê¸€ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ Apps Script ì›¹ì•± URL ===
        // ì•„ë˜ URLì„ ë³¸ì¸ í”„ë¡œì íŠ¸ì˜ ë°°í¬ëœ ì›¹ì•± URLë¡œ êµì²´í•˜ì„¸ìš”.
        // ì˜ˆ: const APPS_SCRIPT_URL = '';
        const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwtDe3Xis0c7V_js-CmLe2NOaHRdOX3c0YldBuYGklGBSkCGzv29_NfCem3gtjEQ8oq/exec'; // ë¹„ì›Œë‘ë©´ ë„¤íŠ¸ì›Œí¬ ì „ì†¡ì„ ìƒëµí•©ë‹ˆë‹¤.

        let currentModuleCount = 2;

        function setModuleCount(count) {
            currentModuleCount = count;
            updateActiveButton(count);

            const table = document.getElementById('meceTable');
            const thead = table.querySelector('thead tr');
            const tbody = table.querySelector('tbody');

            // ê¸°ì¡´ ê°’ ë°±ì—…
            const existingData = [];
            const rows = tbody.querySelectorAll('tr');
            rows.forEach(row => {
                const rowData = [];
                const cells = row.querySelectorAll('td:not(.question-cell)');
                cells.forEach(cell => {
                    const input = cell.querySelector('input');
                    const textarea = cell.querySelector('textarea');
                    rowData.push(input ? input.value : (textarea ? textarea.value : ''));
                });
                existingData.push(rowData);
            });

            // í—¤ë” ì¬êµ¬ì„±
            thead.innerHTML = '<th class="question-col">êµ¬ë¶„</th>';
            for (let i = 1; i <= count; i++) {
                thead.innerHTML += `<th class="module-col">M${i}</th>`;
            }

            // í–‰ ì…€ ì¬ìƒì„± + ê°’ ë³µì›
            const bodyRows = tbody.querySelectorAll('tr');
            bodyRows.forEach((row, rowIndex) => {
                // ê¸°ì¡´ ëª¨ë“ˆ ì…€ ì œê±°
                row.querySelectorAll('td:not(.question-cell)').forEach(cell => cell.remove());

                for (let i = 1; i <= count; i++) {
                    const cell = document.createElement('td');
                    if (row.children[0].textContent === 'ëª¨ë“ˆëª…') {
                        cell.innerHTML = '<input type="text" class="module-name-input" placeholder="ëª¨ë“ˆëª… ì…ë ¥">';
                        if (existingData[rowIndex] && existingData[rowIndex][i-1]) {
                            cell.querySelector('input').value = existingData[rowIndex][i-1];
                        }
                    } else {
                        cell.innerHTML = '<textarea class="mece-input"></textarea>';
                        if (existingData[rowIndex] && existingData[rowIndex][i-1]) {
                            cell.querySelector('textarea').value = existingData[rowIndex][i-1];
                        }
                    }
                    row.appendChild(cell);
                }
            });
        }

        function updateActiveButton(activeCount) {
            document.querySelectorAll('.module-btn').forEach(btn => {
                btn.classList.remove('active');
                const n = parseInt(btn.textContent.match(/\d+/)[0]);
                if (n === activeCount) btn.classList.add('active');
            });
        }

        function submitData() {
            const formData = collectFormData();

            // ì—ëŸ¬ ì´ˆê¸°í™”
            clearAllErrors();

            // ìœ íš¨ì„± ê²€ì‚¬ (ëª¨ë“  í•„ìˆ˜ í•­ëª©ì€ 'ì—†ìŒ'/'X' í—ˆìš©)
            if (!validateFormWithErrors(formData)) {
                alert('ëª¨ë“  í•„ìˆ˜ í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”. ë¹¨ê°„ ê¸€ì”¨ë¡œ í‘œì‹œëœ í•­ëª©ì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ì„±ê³µ ë©”ì‹œì§€
            const successMessage = document.getElementById('successMessage');
            successMessage.style.display = 'block';
            setTimeout(() => { successMessage.style.display = 'none'; }, 3000);

            // === êµ¬ê¸€ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ì „ì†¡ (ì„ íƒ) ===
            // Apps Script ì›¹ì•±ì„ "ëª¨ë“  ì‚¬ìš©ì" ì ‘ê·¼ í—ˆìš© + POST í•¸ë“¤ë§í•˜ê²Œ ë§Œë“¤ì–´ë‘ë©´ ì•„ë˜ fetchë¡œ ìˆ˜ì§‘ë©ë‹ˆë‹¤.
            if (APPS_SCRIPT_URL) {
                try {
                   // ê¸°ì¡´: application/json + JSON.stringify(formData)
// ë³€ê²½: x-www-form-urlencoded + payload=JSON.stringify(...)
fetch(APPS_SCRIPT_URL, {
  method: 'POST',
  headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
  body: 'payload=' + encodeURIComponent(JSON.stringify(formData)),
  mode: 'no-cors'
});
                } catch (e) {
                    console.error('ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ì „ì†¡ ì˜¤ë¥˜:', e);
                }
            }

            // ì…ë ¥ í¼ ì´ˆê¸°í™” (ì›ì¹˜ ì•Šìœ¼ë©´ ì£¼ì„ ì²˜ë¦¬)
            resetForm();
        }

        function clearAllErrors() {
            document.querySelectorAll('.error-message').forEach(msg => msg.style.display = 'none');
            document.querySelectorAll('.error-border').forEach(el => el.classList.remove('error-border'));
        }

        function validateFormWithErrors(formData) {
            let isValid = true;

            // ê¸°ë³¸ ì •ë³´
            if (!formData.basic.instructor) { showError('instructor', 'instructor-error'); isValid = false; }
            if (!formData.basic.company.trim()) { showError('company', 'company-error'); isValid = false; }
            if (!formData.basic.course.trim()) { showError('course', 'course-error'); isValid = false; }
            if (!formData.basic.date) { showError('date', 'date-error'); isValid = false; }

            // ëª¨ë“ˆë³„
            formData.modules.forEach((m, idx) => {
                const i = idx + 1;
                if (!m.name.trim()) { showErrorForTableCell('module-name', i); isValid = false; }
                if (!m.icebreaking.trim()) { showErrorForTableCell('icebreaking', i); isValid = false; }
                if (!m.diagnosis.trim()) { showErrorForTableCell('diagnosis', i); isValid = false; }
                if (!m.videos.trim()) { showErrorForTableCell('videos', i); isValid = false; }
                if (!m.activities.trim()) { showErrorForTableCell('activities', i); isValid = false; }
            });

            // ì „ì²´ ì •ë³´
            if (!formData.overall.learnerReaction.trim()) { showError('learnerReaction', 'learnerReaction-error'); isValid = false; }
            if (!formData.overall.specialNotes.trim()) { showError('specialNotes', 'specialNotes-error'); isValid = false; }

            return isValid;
        }

        function showError(inputId, errorId) {
            const input = document.getElementById(inputId);
            const errorMsg = document.getElementById(errorId);
            if (input) input.classList.add('error-border');
            if (errorMsg) errorMsg.style.display = 'block';
        }

        function showErrorForTableCell(type, moduleIndex) {
            const tbody = document.getElementById('meceTable').querySelector('tbody');
            let rowIndex;
            switch (type) {
                case 'module-name': rowIndex = 0; break;
                case 'icebreaking': rowIndex = 1; break;
                case 'diagnosis': rowIndex = 2; break;
                case 'videos': rowIndex = 3; break;
                case 'activities': rowIndex = 4; break;
            }
            const row = tbody.children[rowIndex];
            const cell = row.children[moduleIndex];
            const input = cell.querySelector('input, textarea');
            if (input) {
                input.classList.add('error-border');
                const existing = cell.querySelector('.error-message');
                if (existing) existing.remove();
                const div = document.createElement('div');
                div.className = 'error-message';
                div.style.display = 'block';
                div.textContent = "ì—†ìœ¼ë©´ 'ì—†ìŒ'ì´ë‚˜ 'X'ë¡œ ê¸°ì¬í•´ì£¼ì„¸ìš”!";
                cell.appendChild(div);
            }
        }

        function resetForm() {
            document.getElementById('instructor').value = '';
            document.getElementById('company').value = '';
            document.getElementById('course').value = '';

            const today = new Date();
            const dateString = `${today.getFullYear()}-${String(today.getMonth()+1).padStart(2,'0')}-${String(today.getDate()).padStart(2,'0')}`;
            document.getElementById('date').value = dateString;

            const inputs = document.getElementById('meceTable').querySelectorAll('input, textarea');
            inputs.forEach(i => i.value = '');

            document.getElementById('learnerReaction').value = '';
            document.getElementById('specialNotes').value = '';
        }

        function collectFormData() {
            const basic = {
                instructor: document.getElementById('instructor').value,
                company: document.getElementById('company').value,
                course: document.getElementById('course').value,
                date: document.getElementById('date').value
            };
            const overall = {
                learnerReaction: document.getElementById('learnerReaction').value,
                specialNotes: document.getElementById('specialNotes').value
            };
            const modules = [];
            const rows = document.getElementById('meceTable').querySelectorAll('tbody tr');

            for (let i = 1; i <= currentModuleCount; i++) {
                modules.push({
                    name: rows[0].children[i].querySelector('input').value || '',
                    icebreaking: rows[1].children[i].querySelector('textarea').value || '',
                    diagnosis: rows[2].children[i].querySelector('textarea').value || '',
                    videos: rows[3].children[i].querySelector('textarea').value || '',
                    activities: rows[4].children[i].querySelector('textarea').value || ''
                });
            }
            return { basic, overall, modules };
        }

        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', () => {
            const today = new Date();
            const dateString = `${today.getFullYear()}-${String(today.getMonth()+1).padStart(2,'0')}-${String(today.getDate()).padStart(2,'0')}`;
            document.getElementById('date').value = dateString;
            updateActiveButton(2);
        });
    </script>
</body>
</html>
